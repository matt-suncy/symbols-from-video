Cloned from: commit 3fe28b8db3e075c358ea8030b157007ad056ae74